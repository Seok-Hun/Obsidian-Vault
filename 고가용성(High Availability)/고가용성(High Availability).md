# 목적
### 비즈니스의 서비스 다운타임을 최소화하여 정보시스템의 가용성 극대화

---

# 방법
### 클러스터링의 컨셉으로 이중화(Redundancy)가 기본이다.
- 최소 2대의 시스템 필요
- 하나의 접점 SPOF(Single Point Of Failure) 구조는 시스템 다운의 리스크를 가지므로 아래와 같이 이중화로 고가용성을 확보한다.
	![[Pasted image 20231015052713.png]]
>[!다중화]
>- 시스템 장애 발생에 대비하여, 장애가 발생하고도 시스템 전체의 기능을 계속 유지하도록 평상시에 예비 장치를 백업으로서 배치해 운용하는 것
>- 예비 1개는 이중화, 2개는 삼중화
>	- 흔히 다중화를 이중화라고 한다.

### 크게 Active-Standby와 Active-Active 두가지의 구성 방법이 있다.
### 기본적인 방법 : Active 서버시스템이 다운되면 자동으로 Standby의 백업 서버 시스템이 작동하도록 구성

---

# 이중화 종류
### Active-Active 구성
![[Pasted image 20231015051134.png]]
- [[Load Balancing(부하분산)|로드밸런싱]] 기능을 가진 L4 스위치 등을  통해 1번, 2번 서버로 나누어 처리하도록 구성
- 웹서버 두에는 무중단시스템 구조를 위해 DB[[서버(Server)|서버]]도 2개로 이중화 해야함
	- 일반적으로 DB서버는 Replica 설정을 하여 2번 DB서버도 실시간으로 복제되게끔 구동시킨다.
### Active-Standby 구성
![[Pasted image 20231015051437.png]]
- [[Load Balancing(부하분산)|부하분산]]을 하는 것이 아니라 장애발생 시 Standby 시스템으로 서비스를 넘기는 Failover 개념
	- Failover 작동을 위해선 주기적으로 Active 서버시스템의 작동 및 연결에 대한 Health Check 필요
		- 이러한 작업을 Heart beat라고 한다.
- 실시간 99.999% 무중단은 아니지만 비즈니스 지속성을 위한 다운타임 허용기준에는 반드시 충족해야 한다.
	- 이 부분은 DRP(Disaster Recovery Plan)과 연결된다.
### 구성 비교

|      구분       |        Active-Active         |          Active-Standby          |
|:---------------:|:----------------------------:|:--------------------------------:|
|    동작방식     |   동시에 서로 교대로 실행    |    Master-Slave 구성으로 동작    |
|    다운타임     |             없음             | Standby로 넘어가는 다운타임 발생 |
|    부하관련     |           부하분산           |             부하집중             |
| 서비스 응답시간 |             빠름             |               지연               |
|     동기화      | Rsync 방식, 동기화 지연 없음 |    Tar 방식, 동기화 지연 발생    |
|  서비스 연속성  |             좋음             |               보통               |

---

# 예시
### 일반적으로 시스템 이중화를 위해 HAProxy & Keepalived 솔루션을 많이 사용한다.
- 가상IP(VIP)를 기반으로 여러 노드간의 모니터링을 수행하고 노드의 장애발생 시 백업노드로 Failover되도록 하는 이중화 지원 소프트웨어이다.
	![[Pasted image 20231015052839.png]]
### HAProxy & Keepalived를 이용한 이중화 아키텍처
- HAProxy & Keepalived 시스템은 프론트앤드 또는 백앤드 서버 앞에 위치할 수 있다.
- VRRP(Virtual Router Redundancy Protocol)를 이용해 이중화를 구성할 수 있다.
- 예시) Server1에 문제 발생 시 자동으로 Server2로 넘어가게 구성
![[Pasted image 20231015053126.png]]
	- VRRP는 VIP라는 가상의 게이트웨이를 설정하여 수시로 서버와의 상태를 체크해야 한다.